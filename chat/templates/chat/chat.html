<!-- chat/templates/chat/chat.html -->

{% load static %}

<!DOCTYPE html>
<html>
<head>
  <!-- Meta -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <!-- Setup -->
  <title>TigerMeet</title>
  <link rel="icon" type="image/png" href="{% static 'cub.png' %}">

  <!-- Semantic UI -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
  <script
  src="https://code.jquery.com/jquery-3.1.1.min.js"
  integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
  crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>

  <script type="text/javascript">
    //var token = {{ access_token }};
    var name = {{ group_name }};
    window.onload = function() 
    {
      //document.getElementById("myToken").innerHTML=token;
      document.getElementById("myName").innerHTML=name;
    }
  </script>
</head>
<body>

  <!--< id="myToken"> </a>-->
  <div class="ui positive message">
    <h1><a id="myName">chatname</a> GroupMe chat successfully created!</h1>
  </div>

  <script>
    $(document).ready(function()
    {
      $('#MyButton').click(function()
      {
        LaunchApp();
      });
    });
  </script>

  <input type="button" value="Open in GroupMe" id="MyButton" >

  <script type="text/javascript">
    // detect if safari mobile
    function isMobileSafari() 
    {
      return navigator.userAgent.match(/(iPod|iPhone|iPad)/) && navigator.userAgent.match(/AppleWebKit/)
    }

    //Launch the element in your app if it's already installed on the phone
    function LaunchApp()
    {
      window.open("GroupMe://","_self");
    };

    if (isMobileSafari())
    {
      // To avoid the "protocol not supported" alert, fail must open itunes store to dl the app, add a link to your app on the store
      var appstorefail = "https://itunes.apple.com/app/GroupMe";
      var loadedAt = +new Date;
      setTimeout(
        function(){
          if (+new Date - loadedAt < 2000){
            window.location = appstorefail;
          }
        }
      ,100);
      LaunchApp()
    }
  </script>

</body>
</html>